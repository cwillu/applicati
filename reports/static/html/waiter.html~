<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://purl.org/kid/ns#">
<head>
<script language="javascript">

  //window.addEventListener('load', init(), false);

  function monitor() {
    var hash = Math.ceil(Math.random()*10000)
    var request = new XMLHttpRequest(); 
    var loc = window.parent.location
	  request.open("get", loc.pathname + "?op=waitForChange;hash=" + hash, true); 
    
    request.onreadystatechange = function() {
      if (request.readyState == 4) {
        if (request.responseText.charAt(request.responseText.length-1)=="!"){
        }
        loc.reload();

        //
        //{
        //    callbackFunction(request.responseText);
        //}
        //setTimeout('window.location.reload();', 50)        
      }
    };	  
	  request.send(null);
    
//	  if(request.status == 205){

//	  }
  }

  window.addEventListener('load', function() {setTimeout('monitor()', 10)}, false);
</script>
</head><body></body></html>
